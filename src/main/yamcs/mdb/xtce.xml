<?xml version="1.0" encoding="UTF-8"?>
<SpaceSystem name="fdirdemo" xmlns="http://www.omg.org/space/xtce" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.omg.org/spec/XTCE/20180204 https://www.omg.org/spec/XTCE/20180204/SpaceSystem.xsd">
	<TelemetryMetaData>
		<ParameterTypeSet>
			<IntegerParameterType name="uint8_t" signed="false">
				<UnitSet />
				<IntegerDataEncoding sizeInBits="8" />
			</IntegerParameterType>
			<IntegerParameterType name="uint16_t" signed="false">
				<UnitSet />
				<IntegerDataEncoding sizeInBits="16" />
			</IntegerParameterType>
			<FloatParameterType name="float_t">
				<UnitSet />
				<FloatDataEncoding sizeInBits="32" />
			</FloatParameterType>
			<IntegerParameterType name="Event_Definition_ID_Type" signed="false">
				<UnitSet />
				<IntegerDataEncoding sizeInBits="16" />
				<DefaultAlarm>
					<StaticAlarmRanges>
						<WatchRange minInclusive="1" maxInclusive="65534" />
					</StaticAlarmRanges>
				</DefaultAlarm>
			</IntegerParameterType>
		</ParameterTypeSet>
		<ParameterSet>
			<Parameter name="ECSS_Version" parameterTypeRef="uint8_t" />
			<Parameter name="ECSS_Service_Type" parameterTypeRef="uint8_t" />
			<Parameter name="ECSS_Message_Type" parameterTypeRef="uint8_t" />
			<Parameter name="ECSS_MessageTypeCounter" parameterTypeRef="uint16_t" />
			<Parameter name="ECSS_03_Housekeeping_Structure_ID" parameterTypeRef="uint8_t" />
			<Parameter name="Temperature_1" parameterTypeRef="float_t" />
			<Parameter name="Temperature_2" parameterTypeRef="float_t" />
			<Parameter name="Event_Definition_ID" parameterTypeRef="Event_Definition_ID_Type" />
		</ParameterSet>
		<AlgorithmSet>
			<CustomAlgorithm name="EventTranscriberAlgorithm">
				<AncillaryDataSet>
					<AncillaryData name="Yamcs:AlgorithmMandatoryInput">eventID</AncillaryData>
					<AncillaryData name="Yamcs:AlgorithmMandatoryInput">messageType</AncillaryData>
				</AncillaryDataSet>
				<AlgorithmText language="JavaScript">
					if (eventID == null) return;

					if (messageType.value == 1) {
						Yamcs.watch("ECSS_Event_Parser", "ECSS_Informative_Event", "ECSS informative event " + eventID.value);
					} else if (messageType.value == 2) {
						Yamcs.warning("ECSS_Event_Parser", "ECSS_LowSev_Anomaly", "ECSS low severity anomaly " + eventID.value);
					} else if (messageType.value == 3) {
						Yamcs.distress("ECSS_Event_Parser", "ECSS_MedSev_Anomaly", "ECSS medium severity anomaly " + eventID.value);
					} else if (messageType.value == 4) {
						Yamcs.critical("ECSS_Event_Parser", "ECSS_HiSev_Anomaly", "ECSS high severity anomaly " + eventID.value);
					}
				</AlgorithmText>
				<InputSet>
					<InputParameterInstanceRef parameterRef="Event_Definition_ID" inputName="eventID" />
					<InputParameterInstanceRef parameterRef="ECSS_Message_Type" inputName="messageType" />
				</InputSet>
			</CustomAlgorithm>
		</AlgorithmSet>
		<ContainerSet>
			<SequenceContainer abstract="true" name="ECSSTM">
				<EntryList>
					<ParameterRefEntry parameterRef="ECSS_Version" />
					<ParameterRefEntry parameterRef="ECSS_Service_Type" />
					<ParameterRefEntry parameterRef="ECSS_Message_Type" />
					<ParameterRefEntry parameterRef="ECSS_MessageTypeCounter" />
				</EntryList>
			</SequenceContainer>
			<SequenceContainer name="Housekeeping">
				<EntryList>
					<ParameterRefEntry parameterRef="ECSS_03_Housekeeping_Structure_ID" />
				</EntryList>
				<BaseContainer containerRef="ECSSTM">
					<RestrictionCriteria>
						<ComparisonList>
							<Comparison value="3" parameterRef="ECSS_Service_Type" />
							<Comparison value="25" parameterRef="ECSS_Message_Type" />
						</ComparisonList>
					</RestrictionCriteria>
				</BaseContainer>
			</SequenceContainer>
			<SequenceContainer name="Housekeeping1">
				<EntryList>
					<ParameterRefEntry parameterRef="Temperature_1" />
					<ParameterRefEntry parameterRef="Temperature_2" />
				</EntryList>
				<BaseContainer containerRef="Housekeeping">
					<RestrictionCriteria>
						<ComparisonList>
							<Comparison value="1" parameterRef="ECSS_03_Housekeeping_Structure_ID" />
						</ComparisonList>
					</RestrictionCriteria>
				</BaseContainer>
			</SequenceContainer>
			<SequenceContainer name="EventReporting">
				<EntryList>
					<ParameterRefEntry parameterRef="Event_Definition_ID" />
				</EntryList>
				<BaseContainer containerRef="ECSSTM">
					<RestrictionCriteria>
						<ComparisonList>
							<Comparison value="5" parameterRef="ECSS_Service_Type" />
							<Comparison comparisonOperator="&gt;=" value="1" parameterRef="ECSS_Message_Type" />
							<Comparison comparisonOperator="&lt;=" value="4" parameterRef="ECSS_Message_Type" />
						</ComparisonList>
					</RestrictionCriteria>
				</BaseContainer>
			</SequenceContainer>
		</ContainerSet>
	</TelemetryMetaData>
	<CommandMetaData>
		<ArgumentTypeSet>
			<IntegerArgumentType name="uint8_t" signed="false">
				<UnitSet />
				<IntegerDataEncoding sizeInBits="8" />
			</IntegerArgumentType>
			<IntegerArgumentType name="uint16_t" signed="false">
				<UnitSet />
				<IntegerDataEncoding sizeInBits="16" />
			</IntegerArgumentType>
			<EnumeratedArgumentType name="AcubeSAT_ECSS_03_Definitions">
				<UnitSet />
				<IntegerDataEncoding sizeInBits="8" />
				<EnumerationList>
					<Enumeration value="1" label="Temperature Housekeeping" />
				</EnumerationList>
			</EnumeratedArgumentType>
		</ArgumentTypeSet>
		<MetaCommandSet>
			<MetaCommand name="ECSSTC" abstract="true">
				<ArgumentList>
					<Argument argumentTypeRef="uint8_t" name="ECSS_Version" />
					<Argument argumentTypeRef="uint8_t" name="ECSS_Service_Type" />
					<Argument argumentTypeRef="uint8_t" name="ECSS_Message_Type" />
					<Argument argumentTypeRef="uint16_t" name="ECSS_Source_ID" />
				</ArgumentList>
				<CommandContainer name="ECSSTCContainer">
					<EntryList>
						<ArgumentRefEntry argumentRef="ECSS_Version" />
						<ArgumentRefEntry argumentRef="ECSS_Service_Type" />
						<ArgumentRefEntry argumentRef="ECSS_Message_Type" />
						<ArgumentRefEntry argumentRef="ECSS_Source_ID" />
					</EntryList>
				</CommandContainer>
			</MetaCommand>
			<MetaCommand name="AcubeSATTC" abstract="true">
				<BaseMetaCommand metaCommandRef="ECSSTC">
					<ArgumentAssignmentList>
						<ArgumentAssignment argumentName="ECSS_Version" argumentValue="32" />
						<ArgumentAssignment argumentName="ECSS_Source_ID" argumentValue="0" />
					</ArgumentAssignmentList>
				</BaseMetaCommand>
				<ArgumentList />
				<CommandContainer name="AcubeSATTC">
					<EntryList />
					<BaseContainer containerRef="ECSSTCContainer" />
				</CommandContainer>
			</MetaCommand>
			<MetaCommand name="Test">
				<BaseMetaCommand metaCommandRef="AcubeSATTC">
					<ArgumentAssignmentList>
						<ArgumentAssignment argumentName="ECSS_Service_Type" argumentValue="17" />
						<ArgumentAssignment argumentName="ECSS_Message_Type" argumentValue="1" />
					</ArgumentAssignmentList>
				</BaseMetaCommand>
				<CommandContainer name="TestContainer">
					<EntryList />
					<BaseContainer containerRef="AcubeSATTC" />
				</CommandContainer>
				<DefaultSignificance consequenceLevel="none" />
			</MetaCommand>
			<MetaCommand name="ECSS03Enable">
				<LongDescription>Enable the generation of housekeeping reports</LongDescription>
				<BaseMetaCommand metaCommandRef="AcubeSATTC">
					<ArgumentAssignmentList>
						<ArgumentAssignment argumentName="ECSS_Service_Type" argumentValue="3" />
						<ArgumentAssignment argumentName="ECSS_Message_Type" argumentValue="5" />
					</ArgumentAssignmentList>
				</BaseMetaCommand>
				<ArgumentList>
					<Argument argumentTypeRef="AcubeSAT_ECSS_03_Definitions" name="Definition" shortDescription="Housekeeping Definition ID" />
				</ArgumentList>
				<CommandContainer name="ECSS03Enable">
					<EntryList>
						<FixedValueEntry name="N" binaryValue="01" sizeInBits="8"/>
						<ArgumentRefEntry argumentRef="Definition" />
					</EntryList>
					<BaseContainer containerRef="AcubeSATTC" />
				</CommandContainer>
				<DefaultSignificance consequenceLevel="watch" />
			</MetaCommand>
			<MetaCommand name="ECSS03Disable">
				<LongDescription>Disable the generation of housekeeping reports</LongDescription>
				<BaseMetaCommand metaCommandRef="AcubeSATTC">
					<ArgumentAssignmentList>
						<ArgumentAssignment argumentName="ECSS_Service_Type" argumentValue="3" />
						<ArgumentAssignment argumentName="ECSS_Message_Type" argumentValue="6" />
					</ArgumentAssignmentList>
				</BaseMetaCommand>
				<ArgumentList>
					<Argument argumentTypeRef="AcubeSAT_ECSS_03_Definitions" name="Definition" shortDescription="Housekeeping Definition ID" />
				</ArgumentList>
				<CommandContainer name="ECSS03Disable">
					<EntryList>
						<FixedValueEntry name="N" binaryValue="01" sizeInBits="8"/>
						<ArgumentRefEntry argumentRef="Definition" />
					</EntryList>
					<BaseContainer containerRef="AcubeSATTC" />
				</CommandContainer>
				<DefaultSignificance consequenceLevel="watch" />
			</MetaCommand>
		</MetaCommandSet>
	</CommandMetaData>
</SpaceSystem>
